const logger = require('winston');

// setup browser global scope polyfills
let { XMLHttpRequest } = require('xmlhttprequest');
global.XMLHttpRequest = XMLHttpRequest;
global.window = {};
global.alert = logger.error;
global.FileReader = require('filereader');

let org_console = global.console;
global.console = {
    log: logger.info
};
global.WebSocket = require('ws');

// init PlayerIO script
// no need to minimize as we're running this on server, file is already loaded
require('./lib/PlayerIOClient.development');

// restore global
global.console = org_console;

// export PlayerIO as module
module.exports = {
    PlayerIO,
    PlayerIOError,
    PlayerIOErrorCode,
};
